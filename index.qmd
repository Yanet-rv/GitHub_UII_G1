---
title: "Análisis estadístico del abono de PORCINAZA Y DENSIDADES OBTIMAS DE SIEMBRA SOBRE EL RENDIMIENTO DE MAÍZ MORADO (Zea mays L.) var. INIA-601."
author: "G1"
format:
  html:
    toc: true
    toc-expand: true
    toc-depth: 4
    toc-location: left
    number-sections: true
    self-contained: true
    code-fold: true
    output-file: "ESM"
editor_options: 
  chunk_output_type: console
execute: 
  warning: false
  message: false
  echo: true
---

# Integrantes G1

1. Colunche Vasquez Josue Jhonatan 
2. Huaman Rimarachin Milver
3. Maicelo Villanueva Luis Miguel
4. Rivera Jimenez Yanet
5. Vasquez Barboza Erik Percy
6. Villa Tochon Jorge Luis<

# INTRODUCCIÓN

El presente trabajo tomado de Zagaceta Llanca (2023) tiene como finalidad analizar estadísticamente los datos experimentales provenientes del estudio “Niveles de porcinaza y densidades de siembra sobre el rendimiento de maíz morado (Zea mays L.) var. INIA-601 en Lámud”, con el propósito de contrastar los resultados originales de la tesis con los obtenidos mediante el procesamiento en R Studio.
El maíz morado es un cultivo de relevancia económica y nutricional en el Perú. Sin embargo, su rendimiento depende de factores agronómicos como la densidad de siembra y el manejo de la fertilización orgánica. En este contexto, la porcinaza constituye una alternativa sostenible que puede mejorar la productividad y la salud del suelo.

A través de herramientas estadísticas y gráficas en R Studio, se busca reproducir el análisis de varianza (ANOVA), la comparación de medias y la visualización de los resultados, verificando la consistencia con los hallazgos reportados en la investigación original.


# OBJETIVOS

## General

Analizar y comparar los resultados obtenidos en la tesis con los generados mediante el procesamiento estadístico en R Studio, evaluando los efectos de los niveles de porcinaza y las densidades de siembra sobre el rendimiento del maíz morado.

## Específicos

1.Organizar los datos experimentales en una base de datos estructurada en formato CSV o Google Sheets.

2.Importar y verificar correctamente los factores experimentales en R Studio (porcinaza, densidad y bloque).

3.Realizar el análisis de varianza (ANOVA) para cada variable evaluada.

4.Efectuar la comparación de medias mediante la prueba de Tukey.

5.Representar los resultados de manera gráfica para visualizar las diferencias entre tratamientos.

6.Contrastar los resultados obtenidos con los reportados en la tesis original.

# DESARROLLO

## Recolección y organización de datos

Los datos experimentales fueron recolectados del anexo de la tesis y organizados en un archivo CSV denominado DBCA_maiz_morado.csv, que contiene los factores y variables evaluadas:

1. Factores: Nivel de porcinaza (0, 160, 320 y 480 g/planta) y Densidad de siembra (0.8×0.4 m y 0.8×0.5 m).

2. Bloques: 4 repeticiones.

3. Variables: Altura de planta, número de mazorcas por planta, longitud, diámetro y peso de mazorca, altura de inserción, número de mazorcas por hectárea y rendimiento de grano por hectárea.

## Librerías

```{r}
library(tidyverse)
library(googlesheets4)
library(lme4)
library(emmeans)
library(FactoMineR)
library(multcomp)
library(car)
library(cowplot)
library(GGally)
```

# Importar base de datos

```{r}
url <- "https://docs.google.com/spreadsheets/d/1o4mtAkI1lBgoUzqDT-e7cIhIwh_K5m6CoxAx0ETvwXU/edit?gid=1753270824#gid=1753270824"

gs <- url %>% 
  as_sheets_id()

fb <- gs %>% 
  range_read("fb") %>% 
  mutate(across(c(tratamientos:bloque), factor))

str(fb)
```

# Variables evaluadas
## VARIABLE 1 Rendimiento
### Modelo estadisticos 

$$ Rendimiento = \mu + bloque + porcinaza + densidad + porcinaza*densidad + e$$
### Analisis de varianza Anova 

Hacer el analisis de varianza y mostrarme la tabla de ANOVA para la variable rend_g_ha en un diseño en bloques completos al azar para la interacción de los factores: densidad	y porcinaza

```{r}
modelo_rend <- aov(rend_g_ha ~ bloque + porcinaza * densidad, data = fb)
anova_rend <- anova(modelo_rend)
print(anova_rend)
```

### Comparación de medias

De la tabla de comparación de medios rend_g_ha, realiza un gráfico de barras con la barra de error y la significnacia. Poner porcinaza en el eje x agrupado por densidad agrega las letras de significancia estadisticas 

```{r}
emmeans_rend <- emmeans(modelo_rend, ~ porcinaza | densidad)
cld_rend <- cld(emmeans_rend, adjust = "tukey", Letters = letters)

ggplot(cld_rend, aes(x = porcinaza, y = emmean, fill = densidad)) +
  geom_col(position = position_dodge(0.9), width = 0.7) +
  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), 
                position = position_dodge(0.9), width = 0.3) +
  geom_text(aes(label = .group, y = upper.CL), 
            position = position_dodge(0.9), vjust = -0.5) +
  labs(x = "Porcinaza (g/planta)", y = "Rendimiento (g/ha)", fill = "Densidad (m)") +
  scale_fill_brewer(type = "qual", palette = "Set2") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.4)), limits = c(0, NA)) +
  theme_minimal()
```

### Boxplot 
Con la base de datos fb hacer boxplot donde en el eje x incluir niveles de porcinaza agrupados por densidad para la variable rend_g_ha

```{r}
ggplot(fb, aes(x = porcinaza, y = rend_g_ha, fill = densidad)) +
  geom_boxplot(position = position_dodge(preserve = "single"), alpha = 0.9, outlier.shape = 19) +
  geom_text(data = cld_rend, aes(y = emmean, label = .group), 
            position = position_dodge(width = 0.8), vjust = -2) +
  labs(
    x = "Porcinaza (g/planta)",
    y = "Rendimiento (g/ha)",
    fill = "Densidad (m)"
  ) +
  scale_fill_brewer(type = "qual", palette = "Set2") +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "top",
    axis.text.x = element_text(angle = 0, vjust = 0.5)
  )
```

##VARIABLE 2 Altura de planta a los 30 días

### Modelo estadisticos a los 30 días
$$ Altup30d = \mu + bloque + porcinaza + densidad + porcinaza*densidad + e$$

### Analisis de varianza Anova a los 30 días

Hacer el análisis de variancia y mostrarme la tabla de ANOVA para la variable 
altu30d en un diseño en bloques completos al azar para la interacción de 
los factores: densidad	 y porcinaza empleando el paquete lme4 

```{r}
md_altu30d <- lmer(altu30d ~ densidad * porcinaza + (1 | bloque), data = fb)

Anova(md_altu30d)
```

### Comparación de medias porcinaza y rendimiento a los 30 días

De la tabla de comparación de medios altu30d, realiza un gráfico de barras con la barra de error y la significnacia. Poner porcinaza en el eje x agrupado por densidad agrega las letras de significancia estadisticas 

```{r}
emmeans_altu30d <- emmeans(md_altu30d, ~ porcinaza | densidad)
cld_altu30d <- cld(emmeans_altu30d, adjust = "tukey", Letters = letters)

ggplot(cld_altu30d, aes(x = porcinaza, y = emmean, fill = densidad)) +
  geom_col(position = position_dodge(0.9), width = 0.7) +
  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), 
                position = position_dodge(0.9), width = 0.3) +
  geom_text(aes(label = .group, y = upper.CL), 
            position = position_dodge(0.9), vjust = -0.5) +
  labs(x = "Porcinaza (g/planta)", y = "Altura 30 días (cm)", fill = "Densidad (m)") +
  scale_fill_brewer(type = "qual", palette = "Set2") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.4)), limits = c(0, NA)) +
  theme_minimal()
```

##VARIABLE 2 Altura de planta a los 180 días
### Modelo estadisticos
$$ Altup180d = \mu + bloque + porcinaza + densidad + porcinaza*densidad + e$$
### Analisis de varianza Anovaa los 180 días

```{r}
md_alt180d <- lmer(alt180d ~ densidad * porcinaza + (1 | bloque), data = fb)

Anova(md_alt180d)
```

### Comparación de medias porcinaza y rendimiento a los 180 días

```{r}
emmeans_alt180d <- emmeans(md_alt180d, ~ porcinaza | densidad)
cld_alt180d <- cld(emmeans_alt180d, adjust = "tukey", Letters = letters)

ggplot(cld_alt180d, aes(x = porcinaza, y = emmean, fill = densidad)) +
  geom_col(position = position_dodge(0.9), width = 0.7) +
  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), 
                position = position_dodge(0.9), width = 0.3) +
  geom_text(aes(label = .group, y = upper.CL), 
            position = position_dodge(0.9), vjust = -0.5) +
  labs(x = "Porcinaza (g/planta)", y = "Altura 180 días (cm)", fill = "Densidad (m)") +
  scale_fill_brewer(type = "qual", palette = "Set2") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.4)), limits = c(0, NA)) +
  theme_minimal()
```

De la tabla de comparación de medios alt180d, realiza un gráfico de barras con la barra de error y la significnacia. Poner porcinaza en el eje x agrupado por densidad.

```{r}
ggplot(cld_alt180d, aes(x = porcinaza, y = emmean, fill = densidad)) +
  geom_col(position = position_dodge(0.9)) +
  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), position = position_dodge(0.9), width = 0.2) +
  geom_text(aes(label = .group, y = upper.CL), position = position_dodge(0.9), vjust = -0.5) +
  labs(x = "Porcinaza (g/planta)", y = "Altura 180 días (cm)", fill = "Densidad") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)), limits = c(0, max(cld_alt180d$upper.CL) * 1.5)) +
  theme_minimal()
```


## VARIABLE 3 Mazorcas por planta

### Modelo estadisticos 

$$ Mazporplanta = \mu + bloque + porcinaza + densidad + porcinaza*densidad + e$$

### Analisis de varianza Anova


```{r}
modelo_maz_p <- lmer(maz_p ~ densidad * porcinaza + (1 | bloque), data = fb)

Anova(modelo_maz_p)
```

### Comparación de medias porcinaza y rendimiento

```{r}
emmeans_maz_p <- emmeans(modelo_maz_p, ~ densidad * porcinaza) %>% 
cld(., Letters = letters)

```

```{r}
ggplot(emmeans_maz_p, aes(x = porcinaza, y = emmean, fill = densidad)) +
  geom_col(position = position_dodge()) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), position = position_dodge(0.9), width = 0.2) +
  geom_text(aes(label = .group, y = emmean + SE), position = position_dodge(0.9), vjust = -0.5) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.4)))
```

### Boxplot

```{r}
ggplot(fb, aes(x = porcinaza, y = maz_p, fill = densidad)) +
  geom_boxplot() 
```

# Análisis multivariante PCA 

De la base de datos fb, hacer un PCA agrupado por densidad y porcinasa usando el paquete FactoMineR

```{r}
PCA(fb[, 5:13], quali.sup = 1:4, graph = T)

```

```{r}
dtmv <- fb %>%
  group_by(porcinaza, densidad) %>%
  summarise(across(where(is.numeric)
                   , ~ mean(., na.rm = T))) %>% 
  unite("trat", c(porcinaza, densidad), remove = F) %>% 
  column_to_rownames("trat")
  pca <- PCA(X = dtmv, scale.unit = T
           , quali.sup = c(1, 2))  

  
var <- plot(pca, choix = "var")

ind <- plot(pca, choix = "ind")

list(var, ind) %>% 
  plot_grid(plotlist =., ncol = 2, labels = "auto")
```

```{r}
library(GGally)

ggplot(dtmv, aes(x = NULL, y = NULL)) + geom_blank() + theme_void()

ggcorr(dtmv %>% dplyr::select(where(is.numeric)))

```


# CONCLUSIONES

En concluión las trs variables evaluadas 

# REFERENCIA BIBLIOGRAFICA

Zagaceta Llanca (2023). Niveles de porcinaza y densidades de siembra sobre el rendimiento de maíz morado (Zea mays L.) var. INIA-601 en Lámud.








