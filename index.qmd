---
title: "Análisis estadístico del abono de PORCINAZA Y DENSIDADES OBTIMAS DE SIEMBRA SOBRE EL RENDIMIENTO DE MAÍZ MORADO (Zea mays L.) var. INIA-601."
author: "G1"
format:
  html:
    toc: true
    toc-expand: true
    toc-depth: 4
    toc-location: left
    number-sections: true
    self-contained: true
    code-fold: true
    output-file: "ESM"
editor_options: 
  chunk_output_type: console
execute: 
  warning: false
  message: false
  echo: true
---

![](https://aula.untrm.edu.pe/pluginfile.php/1/theme_moove/logo/1649453146/Sin%20t%C3%ADtulo-1.png){width=90% align="center"}               

# Integrantes G1

1. Colunche Vasquez Josue Jhonatan 
2. Huaman Rimarachin Milver
3. Maicelo Villanueva Luis Miguel
4. Rivera Jimenez Yanet
5. Vasquez Barboza Erik Percy
6. Villa Tochon Jorge Luis

# INTRODUCCIÓN

El presente trabajo tomado de Zagaceta Llanca (2023) tiene como finalidad analizar estadísticamente los datos experimentales provenientes del estudio “Niveles de porcinaza y densidades de siembra sobre el rendimiento de maíz morado (Zea mays L.) var. INIA-601 en Lámud”, con el propósito de contrastar los resultados originales de la tesis con los obtenidos mediante el procesamiento en R Studio.
El maíz morado es un cultivo de relevancia económica y nutricional en el Perú. Sin embargo, su rendimiento depende de factores agronómicos como la densidad de siembra y el manejo de la fertilización orgánica. En este contexto, la porcinaza constituye una alternativa sostenible que puede mejorar la productividad y la salud del suelo.

A través de herramientas estadísticas y gráficas en R Studio, se busca reproducir el análisis de varianza (ANOVA), la comparación de medias y la visualización de los resultados, verificando la consistencia con los hallazgos reportados en la investigación original.


# OBJETIVOS

## General

Analizar y comparar los resultados obtenidos en la tesis con los generados mediante el procesamiento estadístico en R Studio, evaluando los efectos de los niveles de porcinaza y las densidades de siembra sobre el rendimiento del maíz morado.

## Específicos

1.Organizar los datos experimentales en una base de datos estructurada en formato CSV o Google Sheets.

2.Importar y verificar correctamente los factores experimentales en R Studio (porcinaza, densidad y bloque).

3.Realizar el análisis de varianza (ANOVA) para cada variable evaluada.

4.Efectuar la comparación de medias mediante la prueba de Tukey.

5.Representar los resultados de manera gráfica para visualizar las diferencias entre tratamientos.

6.Contrastar los resultados obtenidos con los reportados en la tesis original.

# DESARROLLO

## Recolección y organización de datos

Los datos experimentales fueron recolectados del anexo de la tesis y organizados en un archivo CSV denominado DBCA_maiz_morado.csv, que contiene los factores y variables evaluadas:

1. Factores: Nivel de porcinaza (0, 160, 320 y 480 g/planta) y Densidad de siembra (0.8×0.4 m y 0.8×0.5 m).

2. Bloques: 4 repeticiones.

3. Variables: Altura de planta, número de mazorcas por planta, longitud, diámetro y peso de mazorca, altura de inserción, número de mazorcas por hectárea y rendimiento de grano por hectárea.

## Librerías

```{r}
library(tidyverse)
library(googlesheets4)
library(emmeans)
library(lme4)
```

## Cargar base de datos

https://docs.google.com/spreadsheets/d/1o4mtAkI1lBgoUzqDT-e7cIhIwh_K5m6CoxAx0ETvwXU/edit?gid=1955940309#gid=1955940309

```{r}
url  <- "https://docs.google.com/spreadsheets/d/1o4mtAkI1lBgoUzqDT-e7cIhIwh_K5m6CoxAx0ETvwXU/edit?gid=1753270824#gid=1753270824"

gs <- url %>% 
  as_sheets_id()

fb <- gs %>% 
  range_read("fb") %>% 
  mutate(across(1:bloque, ~as.factor(.)))

str(fb)
```

## Variable 1: Rendimiento gramos/ha

### Modelo lineal mixto

$$  Porcinaza_{rendimineto} = \mu + bloque + porcinaza +densidad + porcinaza*densidad + e $$

### ANÁLISIS DE VARIANZA

```{r}
md <- lmer(formula = rendiminto_g_ha ~ 0 + (1|bloque) + porcinaza*densidad
           , data = fb)
anova(md)

```

```{r}
library(car)
```
```{r}
Anova(md)
```
Interpretación general

El tratamiento que combinó 480 g/planta de porcinaza y la densidad de 0,8×0,5 m alcanzó los valores más altos en altura de planta, longitud y peso de mazorca, y rendimiento de grano por hectárea, confirmando que la mayor disponibilidad de nutrientes orgánicos junto con un espaciamiento adecuado optimizan el aprovechamiento de recursos (agua, luz y nutrientes), incrementando la productividad del maíz morado var. INIA-601 en las condiciones agroecológicas de Lámud (Amazonas).

Por lo tanto, el uso de porcinaza en dosis de 480 g/planta y densidad de siembra de 0,8×0,5 m constituye una estrategia agronómica efectiva para mejorar el rendimiento y promover la sostenibilidad del cultivo en la región.

### Comparación de medias 

```{r}
# Cargar paquetes
library(lme4)
library(lmerTest)
library(emmeans)
library(multcomp)
library(multcompView)
library(dplyr)
library(ggplot2)

# Asegurar que las variables tengan el formato correcto
fb <- fb %>%
  mutate(
    mazorca_ha = as.numeric(unlist(mazorca_ha)),
    bloque = as.factor(bloque),
    porcinaza = as.factor(porcinaza),
    densidad = as.factor(densidad)
  )

# Modelo lineal mixto

md <- lmer(formula = rendiminto_g_ha ~ 0 + (1|bloque) + porcinaza*densidad
           , data = fb)

# ANOVA
anova(md)

```

“El análisis de varianza mostró diferencias altamente significativas para el factor Porcinaza (p < 0.001), indicando que las dosis aplicadas influyeron significativamente en el rendimiento de grano. No se observaron efectos significativos de la densidad de siembra ni de la interacción entre ambos factores (p > 0.05). Por lo tanto, el incremento del rendimiento se atribuye principalmente al efecto de la porcinaza, independientemente de la densidad de siembra utilizada.”


```{r}
# Medias ajustadas del modelo
em_mazorca <- emmeans(md, ~ porcinaza * densidad)

# Letras de significancia (Tukey)
cld_mazorca <- cld(em_mazorca,
                   adjust = "tukey",
                   Letters = letters,
                   alpha = 0.05)

# Ver resultados
cld_mazorca

```

```{r}
# Convertir a data frame
df_cld <- as.data.frame(cld_mazorca)

# Gráfico de barras agrupadas
ggplot(df_cld, aes(x = porcinaza, y = emmean, fill = densidad)) +
  geom_col(position = position_dodge(0.8), width = 0.6, alpha = 0.85) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE),
                position = position_dodge(0.8), width = 0.2) +
  geom_text(aes(label = .group),
            position = position_dodge(0.8),
            vjust = -0.5,
            size = 5) +
  labs(
    title = "Comparación de medias Porcinaza × Densidad\n(Mazorcas por hectárea)",
    x = "Porcinaza",
    y = "Media ajustada (mazorca_ha)",
    fill = "Densidad"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    legend.position = "top"
  )

```
Interpretación 

La dosis de porcinaza influye significativamente en la cantidad de mazorcas por hectárea.
A medida que aumenta la dosis (0 → 480 kg/ha), la producción crece progresivamente.

La densidad también influye:

La densidad 0.8x0.5 m (barras azules) supera ligeramente a la de 0.8x0.4 m, sobre todo en las dosis altas.

La mejor combinación fue 480 kg/ha de porcinaza con densidad 0.8x0.5 m, que muestra la letra “q”, indicando la media más alta y estadísticamente diferente de las demás.

Las dosis bajas (0 y 160 kg/ha) no presentan diferencias significativas entre densidades ni entre sí (ambas con letra “a” o “ab”).

```{r}

library(emmeans)

# Medias ajustadas y comparaciones múltiples (Tukey)
em <- emmeans(md, pairwise ~ porcinaza * densidad, adjust = "tukey")

# Mostrar resultados
em$emmeans   # Medias ajustadas por tratamiento
em$contrasts # Comparaciones múltiples (Tukey)

```


```{r}
emmeans(md, pairwise ~ porcinaza, adjust = "tukey")
emmeans(md, pairwise ~ densidad, adjust = "tukey")

```

```{r}
library(ggplot2)

ggplot(fb, aes(x = porcinaza, y = rendiminto_g_ha, fill = porcinaza)) +
  geom_boxplot(alpha = 0.8, outlier.color = "red") +
  facet_wrap(~ densidad) +
  labs(
    title = "Interacción entre Porcinaza y Densidad en el rendimiento (g/ha)",
    x = "Porcinaza",
    y = "Rendimiento (g/ha)"
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "none")

```

En la Figura: Se observa la interacción entre los niveles de porcinaza y las densidades de siembra sobre el rendimiento del maíz morado var. INIA-601. Se evidencia que el incremento de la dosis de porcinaza favorece significativamente el rendimiento en ambas densidades evaluadas.

A dosis bajas (0 y 160 g/planta), las diferencias entre densidades son poco marcadas; sin embargo, a dosis intermedias y altas (320 y 480 g/planta), la densidad de 0.8×0.5 m permite alcanzar rendimientos superiores, lo que confirma una interacción positiva entre los factores.

El tratamiento de 480 g/planta de porcinaza con densidad 0.8×0.5 m presentó la mayor mediana de rendimiento (superior a 5000 g/ha), con menor variabilidad entre repeticiones, lo que indica una respuesta estable y productiva del cultivo bajo esta combinación.

En conjunto, estos resultados respaldan que el uso adecuado de porcinaza y un espaciamiento óptimo mejoran de manera significativa la productividad y sostenibilidad del maíz morado en condiciones de Lámud (Amazonas)


## variable 2: altura de planta a los 30 dias 

### Modelo


$$  Porcinaza_{altura30d} = \mu + bloque + porcinaza +densidad + porcinaza*densidad + e $$
```{r}
# Librerías necesarias
library(lme4)
library(lmerTest)
library(emmeans)
library(multcomp)
library(multcompView)
library(dplyr)
library(ggplot2)

```

```{r}
# Asegurar formato correcto de variables
fb <- fb %>%
  mutate(
    altura30d = as.numeric(unlist(altura30d)),
    bloque = as.factor(bloque),
    porcinaza = as.factor(porcinaza),
    densidad = as.factor(densidad)
  )

# Verificar estructura
str(fb$altura30d)

```

### Anova

```{r}
# Ajuste del modelo
md_altura30 <- lmer(altura30d ~ 0 + (1 | bloque) + porcinaza * densidad,
                    data = fb)

# Análisis de varianza
anova(md_altura30)

```

```{r}
# Medias ajustadas del modelo
em_altura30 <- emmeans(md_altura30, ~ porcinaza * densidad)

# Letras de significancia (Tukey)
cld_altura30 <- cld(em_altura30,
                    adjust = "tukey",
                    Letters = letters,
                    alpha = 0.05)

# Mostrar resultados
cld_altura30

```

```{r}
# Convertir a data frame
df_cld_altura30 <- as.data.frame(cld_altura30)

# Gráfico de barras agrupadas
ggplot(df_cld_altura30, aes(x = porcinaza, y = emmean, fill = densidad)) +
  geom_col(position = position_dodge(0.8), width = 0.6, alpha = 0.85) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE),
                position = position_dodge(0.8), width = 0.2) +
  geom_text(aes(label = .group),
            position = position_dodge(0.8),
            vjust = -0.5,
            size = 5) +
  labs(
    title = "Comparación de medias Porcinaza × Densidad\nAltura de planta a los 30 días",
    x = "Porcinaza",
    y = "Altura de planta (cm)",
    fill = "Densidad"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    legend.position = "top"
  )

```

variable 03: Altura de plantas 180 dias

### Modelo


$$  Porcinaza_{altura180d} = \mu + bloque + porcinaza +densidad + porcinaza*densidad + e $$
```{r}
library(lme4)
library(lmerTest)
library(emmeans)
library(multcomp)
library(multcompView)
library(dplyr)
library(ggplot2)

```



# CONCLUSIONES

En concluión las trs variables evaluadas 

#REFERENCIA BIBLIOGRAFICA

Zagaceta Llanca (2023). Niveles de porcinaza y densidades de siembra sobre el rendimiento de maíz morado (Zea mays L.) var. INIA-601 en Lámud.


martes/28/octubre





